#
# The gitlab CI script for luSolve
#

stages:
  - setup
  - build
  - test
  - benchmark

setup_job:
  stage: setup
  script:
    - stack setup
  tags:
    - stack-runner
  when: manual

build_job:
  stage: build
  script:
    - stack build --pedantic
  tags:
    - stack-runner

test_job:
  stage: test
  script:
    - stack test --pedantic --coverage
  tags:
    - stack-runner

benchmark_job:
  stage: benchmark
  script:
    - stack bench --benchmark-arguments '--time-limit 30'
  tags:
    - stack-runner
